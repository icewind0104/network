{% extends "base.html" %}

{% block head %}
<script type="text/javascript">
    $('document').ready(function(){
        //alert('hello world!')
        $("a.success").click(
            function(){
                $("#usebox #addr").val($(this).attr('id'));
                $("form#ipAdd").attr("action", "{{prefix}}/ip/add/");
            });

        $("a.modify").click(
            function(){
                //$("#modifybox #addr").val($(this).attr('id'));
                $("#modifybox #name").val($(this).parent().parent().parent().find('td#name').text());
                $("#modifybox #department").val($(this).parent().parent().parent().find('td#department').text());
                $("form#ipUpdate").attr("action", "{{prefix}}/employees/"+$(this).attr('id')+"/update/");
            });

        $("a.danger").click(
            function(){
                $("#deletebox").find(".motion").text(
                    $(this).parent().parent().parent().find("#name").text()
                );
                $("form#ipDelete").attr("action", "{{prefix}}/employees/"+$(this).attr('id')+"/delete/");
            });

    });
</script>
{% endblock %}

{% block left %}
    <ul class="uk-nav uk-nav-side uk-nav-parent-icon">
        {% if current_user.is_authenticated and current_user.catagory == 'administrator' %}
        <li>
            <a href="#netaddbox" data-uk-modal><i class="uk-icon-plus-square"></i>&nbsp新增员工</a>
        </li>
        <li class="uk-nav-divider"></li>
        {% endif %}
    </ul>
{% endblock %}

{% block right %}
    <div class="uk-width-3-4">
        <!-- search box -->
        <div class="uk-container" style="padding:0px;" data-uk-sticky="{top:10}">
            <div class="uk-flex-right uk-grid">
                <div class="uk-width-1-2"></div>
                <div class="uk-text-right uk-width-1-2">
                <form class="uk-form" method="POST" action="{{prefix}}/employee/">
                    <fieldset data-uk-margin>
                        <div class="uk-form-icon"><i class="uk-icon-search"></i>
                        <input placeholder="search..." autocomplete="off" type="text" name="search" value="{% if search_key %}{{search_key}}{% endif %}">
                        <button class="uk-button mybutton">搜索</button></div>
                    </fieldset>
                </form>
                </div>
            </div>
        </div>

        <!-- table list -->
        <div class="uk-overflow-container">
            <table class="uk-table uk-text-nowrap uk-table-hover uk-table-striped">
                <thead>
                    <tr style="background-image:linear-gradient(to bottom,#fff,#eee);">
                        <th class="">员工姓名</th>
                        <th class="">所在部门/项目组</th>
                        {% if current_user.is_authenticated and current_user.catagory == 'administrator' %}
                        <th class="">操作</th>
                        {% endif %}
                    </tr>
                </thead>
                <tbody>
                {% for employee in employees %}
                    <tr class="uk-visible-hover-inline" id="">
                        <td id="name" class="">{{ employee.name|safe }}</td>
                        <td id="department" class="">{{ employee.department|safe }}</td>
                        {% if current_user.is_authenticated and current_user.catagory == 'administrator' %}
                        <td  class="">
                            <!-- Operators -->
                            <div>
                                <a id="{{employee.id}}" class="modify" href="#modifybox" data-uk-modal><i class="uk-icon-pencil-square-o"></i></a>
                                <a id="{{employee.id}}" class="danger" href="#deletebox" data-uk-modal><i class="uk-icon-times-circle"></i></a>
                            </div>
                        </td>
                        {% endif %}
                    </tr>
                {% endfor %}
                </tbody>
            </table>
            {% if not employees %}
            <div class="uk-alert uk-alert-warning">
                {% if IP_count %}未找到相关内容 ....{% else %}点击左侧网络或使用搜索查找信息{%endif%}
            </div>
            {% endif %}
        </div>

        <!-- pagination -->
        {% if Page %}
        <ul class="uk-pagination uk-panel uk-panel-box" style="padding:15px;">
            {% if Page.previous_page %}
                <li><a href="{{prefix}}/employee/{{ processor_generate_search(page=Page.previous_page, search=search) }}"><span><<</span></a></li>
            {% else %}
                <li class="uk-disabled"><span>&lt;&lt;</span></li>
            {% endif %}

            {% for p in Page.all_page() %}
                {% if p == "..." %}<li><span>{{p}}</span></li>
                {% else %}
                    {% if p == Page.curr_page %}
                        <li class="uk-active"><span>{{p}}</span></li>
                    {% else %}
                        <li><a href="{{prefix}}/employee/{{ processor_generate_search(page=p, search=search) }}">{{p}}</a></li>
                    {% endif %}
                {% endif %}
            {% endfor %}

            {% if Page.next_page %}
                <li><a href="{{prefix}}/employee/{{ processor_generate_search(page=Page.next_page, search=search) }}"><span>>></span></a></li>
            {% else %}
                <li class="uk-disabled"><span>&gt;&gt;</span></li>
            {% endif %}
        </ul>
        {% endif %}

    </div>

{% endblock %}

{% block windows %}
{% if current_user.is_authenticated and current_user.catagory == 'administrator' %}
<form action="" id="ipUpdate" class="uk-form uk-form-horizontal" method="POST">
    {{ form.hidden_tag() }}
    <div id="modifybox" class="uk-modal">
        <div class="uk-modal-dialog">
            <div class="uk-modal-header uk-grid"><i class="uk-icon-pencil-square-o uk-icon-medium" style="color:#07d;"></i><h2>修改使用人</h2></div>
            <div class="uk-form-row"><label class="uk-form-label">员工姓名</label><div class="uk-form-controls">
                {{ form.name }}
            </div></div>
            <div class="uk-form-row"><label class="uk-form-label">所在部门</label><div class="uk-form-controls">
                {{ form.department }}
            </div></div>
            <div class="uk-modal-footer uk-text-right">
                <button class="uk-button uk-modal-close" type="button">取消</button>
                <button class="uk-button uk-button-primary">确定</button>
            </div>
        </div>
    </div>
</form>
<form action="" id="ipDelete" class="uk-form" method="POST">
    <div id="deletebox" class="uk-modal">
        <div class="uk-modal-dialog">
            <div class="uk-modal-header uk-grid"><i class="uk-icon-times-circle uk-icon-medium" style="color:#f00;"></i><h2>删除IP地址</h2></div>
            确定删除&nbsp;<span class="motion"></span>&nbsp;吗？
            <input type="text" class="uk-hidden" name="ip_id" id="delete_ip_id">
            <input type="text" class="uk-hidden" name="operate" value="delete">
            <div class="uk-modal-footer uk-text-right">
                <button class="uk-button uk-modal-close" type="button">取消</button>
                <button class="uk-button uk-button-danger">确定</button>
            </div>
        </div>
    </div>
</form>

<form action="{{prefix}}/employees/add/" class="uk-form uk-form-horizontal" method="POST">
    {{ form.hidden_tag() }}

    <div id="netaddbox" class="uk-modal">
        <div class="uk-modal-dialog">
            <div class="uk-modal-header uk-grid"><i class="uk-icon-plus uk-icon-medium" style="color:#8CC14C;"></i><h2>添加新网络</h2></div>

            <div class="uk-form-row"><label class="uk-form-label">员工姓名<span style="color:#07d;">（必填）</span></label><div class="uk-form-controls">
                {{ form.name }}
            </div></div>

            <div class="uk-form-row"><label class="uk-form-label">所在部门/项目组<span style="color:#07d;">（必填）</span></label><div class="uk-form-controls">
                {{ form.department }}
            </div></div>

            <div class="uk-modal-footer uk-text-right">
                <button class="uk-button uk-modal-close" type="button">取消</button>
                <button class="uk-button uk-button-primary" type="submit">确定</button>
            </div>
        </div>
    </div>
</form>
{% endif %}
{% endblock %}
